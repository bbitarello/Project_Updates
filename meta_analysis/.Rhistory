getwd()
library(flexdashboard)
library(data.table)
library(ggplot2)
library("wesanderson")
library(shiny)
library(DT)
library(rmarkdown)
library(markdown)
library("htmltools")
library("base64enc")
library(knitr)
source('render_with_widgets.R')
library(flexdashboard)
library(data.table)
library(ggplot2)
library("wesanderson")
library(shiny)
library(DT)
library(rmarkdown)
library(markdown)
library("htmltools")
library("base64enc")
library(knitr)
#source('render_with_widgets.R')
getwd()
setwd('prs/)
setwd('prs/')
library(devtools)
install_github("stephenturner/qqman", ref="dev")
library(qqman)
vignette("manhattan")
vignette("manhattan")
head(gwasResults)
manhattan(gwasResults)
qq(gwasResults$P)
gwas
gwasResults
head(gwasResults)
dim(gwasResults)
snpsOfInterest
swtwd('~/Documents/GitHub/Project_Updates/')
swtwd('~/Documents/GitHub/Project_Updates/')
setwd('~/Documents/GitHub/Project_Updates/')
list.files()
system('mkdir meta_analysis')
setwd('meta_analysis/)
setwd('meta_analysis/')
gwetwd()
getwd()
render('index.Rmd')
rmarkdown::render('index.Rmd')
rmarkdown::render('index.Rmd')
library(flexdashboard)
dt<-data.table(Datasets=("pan_UKBB","Uganda Genome Project", "N'diaye et al.", "PAGE"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries"), Total_Sample_Size=c(6636,14126,20427,49781)
rmarkdown::render(input = "dash
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome Project", "N'diaye et al.", "PAGE"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries"), Total_Sample_Size=c(6636,14126,20427,49781))
library(flexdashboard)
library(data.table)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome Project", "N'diaye et al.", "PAGE"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries"), Total_Sample_Size=c(6636,14126,20427,49781))
my_table<-datatable(dt,options = list(pageLength = 12))
library(flexdashboard)
library(data.table)
library(DT)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome Project", "N'diaye et al.", "PAGE"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries"), Total_Sample_Size=c(6636,14126,20427,49781))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome Project", "N'diaye et al.", "PAGE", "panUKBB_AFR+UGP+NDIAYE+PAGE_ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR_Size=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other_Size=c(0,0,0,(49839-17299),(49839-17299)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "panUKBB_AFR+UGP+NDIAYE+PAGE_ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR_Size=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other_Size=c(0,0,0,(49839-17299),(49839-17299)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
NCORES <- nb_cores()
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
install.packages('GWASTools')
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library('GWASTools')
install.packages("GWASTools")
library('GWASTools')
BiocManager::install("GWASTools")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GWASTools")
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
install.packages("bigsnpr)
install.packages("bigsnpr")
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
NCORES <- nb_cores()
NCORES
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "panUKBB_AFR+UGP+NDIAYE+PAGE_ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR_Size=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other_Size=c(0,0,0,(49839-17299),(49839-17299)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "panUKBB_AFR+UGP+NDIAYE+PAGE_ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR_Size=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other_Size=c(0,0,0,(49839-17299),(49839-17299)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "panUKBB_AFR+UGP+NDIAYE+PAGE_ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR_Size=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other_Size=c(0,0,0,(49839-17299),(49839-17299)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
library(flexdashboard)
library(data.table)
library(ggplot2)
library("wesanderson")
library(shiny)
library(DT)
library(rmarkdown)
library(markdown)
library("htmltools")
library("base64enc")
library(knitr)
library(flexdashboard)
library(data.table)
library(ggplot2)
library("wesanderson")
library(shiny)
library(DT)
library(rmarkdown)
library(markdown)
library("htmltools")
library("base64enc")
library(knitr)
library(flexdashboard)
library(data.table)
library(ggplot2)
library("wesanderson")
library(shiny)
library(DT)
library(rmarkdown)
library(markdown)
library("htmltools")
library("base64enc")
#library(knitr)
#source('render_with_widgets.R')
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
#htmltools::includeHTML("widget_table.html")
knit_with_parameters('~/Documents/GitHub/Project_Updates/meta_analysis/dashboard.Rmd')
getwd()
inytex::install_tinytex()
tinytex::install_tinytex()
log10(0.00000005)
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
unlink('notebook_cache', recursive = TRUE)
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
library(knitr)
library(knitr)
library(kable)
unlink('notebook_cache', recursive = TRUE)
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
#library(knitr)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR_Size+Total_other_Size][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR_Size+Total_other_Size][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR+Total_other][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(dt)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))
my_table<-datatable(dt,options = list(pageLength = 12))[Phenotype=='HEIGHT']
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='HEIGHT']
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='HEIGHT']
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
#library(knitr)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR+Total_other][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(dt)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR+Total_other][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(dt)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(my_table)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(my_table)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(my_table)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
#my_table<-datatable(dt,options = list(pageLength = 12))
knitr::kable(dt)
install.packages("CMplot")
library(cairo)
library(Cairo)
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
library("wesanderson")
library(rmarkdown)
library(plotly)
#library(knitr)
dt2<-dt[Method=='LDpred-Inf'][Phenotype=='Height']
#dt2$Phenotype<-factor(dt2$Phenotype, levels=c('Height', 'BMI'))
my_plot2<-ggplot(dt2, aes(x=`Main Test Cohort Ancestry`,y=`Variance Explained (%)`, colour=`Discovery Cohort`)) +
#        facet_wrap(~Phenotype, dir='v') +
geom_point(size=3) +
scale_color_manual(values = wes_palette("Darjeeling2")) +
theme_bw()+
labs(title="Height")
ggplotly(my_plot2,tooltip="text")
dt2<-dt[Method=='LDpred-Inf'][Phenotype=='Height']
#dt2$Phenotype<-factor(dt2$Phenotype, levels=c('Height', 'BMI'))
my_plot2<-ggplot(dt2, aes(x=`Main Test Cohort Ancestry`,y=`Variance Explained (%)`, colour=`Discovery Cohort`)) +
#        facet_wrap(~Phenotype, dir='v') +
geom_point(size=3) +
scale_color_manual(values = wes_palette("Darjeeling2")) +
theme_bw()+
labs(title="Height")
p<-ggplotly(my_plot2,tooltip="text")
install.packages(“dash”)
install.packages("dash")
library(dash)
library(flexdashboard)
library(data.table)
library(DT)
library(dplyr)
library(readr)
library(ggplot2)
library('GWASTools')
library(qqman)
library(bigsnpr)
library(kableExtra)
library("wesanderson")
library(rmarkdown)
library(plotly)
#library(knitr)
dt<-data.table(Datasets=c("pan_UKBB","Uganda Genome \nProject", "N'diaye et al.", "PAGE", "ALL"), Subsets=c("AFR","All from meta-analysis (AFR)","All from meta-analysis (AFR)", "All ancestries", "ALL"), Total_AFR=c(6636,14126,20427,17299, sum(c(6636,14126,20427,17299))), Total_other=c(0,0,0,(49839-17299),(49839-17299)))[,Grant_total:=Total_AFR+Total_other][, Lambda:=c(1.037,"0.823*",1.065,1.183, NA)]
my_table<-datatable(dt,options = list(pageLength = 12))
my_table
#knitr::kable(dt)
dt=do.call(rbind, lapply(list.files(pattern="*.csv"), function(X) fread(X, sep=",", header=T)))[Phenotype=='Height']
my_table<-datatable(dt,options = list(pageLength = 12))
#knitr::kable(dt)
my_table
dt2<-dt[Method=='LDpred-Inf'][Phenotype=='Height']
#dt2$Phenotype<-factor(dt2$Phenotype, levels=c('Height', 'BMI'))
my_plot2<-ggplot(dt2, aes(x=`Main Test Cohort Ancestry`,y=`Variance Explained (%)`, colour=`Discovery Cohort`)) +
#        facet_wrap(~Phenotype, dir='v') +
geom_point(size=3) +
scale_color_manual(values = wes_palette("Darjeeling2")) +
theme_bw()+
labs(title="Height")
p<-ggplotly(my_plot2,tooltip="text")
capabilities()
install.packages('Cairo')
library(Cairo)
